{
  "pluginAlias": "Doorbird",
  "pluginType": "platform",
  "singular": true,
  "headerDisplay": "Doorbirds are exposed to HomeKit as separate accessories and each needs to be manually paired.\n\n1. Open the Home <img src='https://user-images.githubusercontent.com/3979615/78010622-4ea1d380-738e-11ea-8a17-e6a465eeec35.png' height='16.42px'> app on your device.\n2. Tap the Home tab, then tap <img src='https://user-images.githubusercontent.com/3979615/78010869-9aed1380-738e-11ea-9644-9f46b3633026.png' height='16.42px'>.\n3. Tap *Add Accessory*, and select *I Don't Have a Code or Cannot Scan*.\n4. Enter the Homebridge PIN, this can be found under the QR code in Homebridge UI or your Homebridge logs, alternatively you can select *Use Camera* and scan the QR code again.\n\nFor help and examples of common configurations please read the [wiki](https://github.com/KhaosT/homebridge-camera-ffmpeg/wiki).",
  "footerDisplay": "The **ffmpeg** binary must be installed on your system for this plugin to work.<BR>For audio support, make sure your version of ffmpeg is compiled with support for **fdk-aac**.",
  "schema": {
    "name": {
      "title": "Name",
      "description": "Name you want to assign to the Doorbird platform plugin. Default: Doorbird",
      "type": "string"
    },

    "videoProcessor": {
      "title": "Video Processor",
      "description": "Path to ffmpeg or your preferred video processor.",
      "type": "string"
    },

    "audio": {
      "title": "Enable Audio",
      "description": "Enable audio support for all configured Doorbirds. This requires a version of ffmpeg compiled with libfdk-aac. Default: false",
      "type": "boolean"
    },

    "debug": {
      "title": "Plugin Debug Mode",
      "description": "Enable debug mode for the plugin. Default: false",
      "type": "boolean"
    },

    "doorbirds": {
      "type": "array",
      "items": {
        "title": "Doorbird Configuration",
        "type": "object",
        "properties": {
          "name": {
            "title": "Doorbird Name",
            "description": "Name for this Doorbird.",                        
            "type": "string"
          },
          
          "ip": {
            "title": "DoorBird IP Address",
            "description": "IP address for this Doorbird.",
            "type": "string",
            "format": "ipv4",
            "placeholder": "Enter Doorbird IP address",
            "required": true
          },
          
          "username": {
            "title": "Username",
            "description": "Username for this Doorbird",
            "type": "string",
            "placeholder": "Enter Doorbird username",
            "required": true
          },
          
          "password": {
            "title": "Password",
            "description": "Password for the Doorbird user.",
            "type": "string",
            "placeholder": "Enter Doorbird password",
            "required": true
          },
          
          "cmdDoorbell": {
            "title": "Doorbell Command",
            "description": "Command line to execute when a doorbell event is detected.",
            "type": "string"
          },
          
          "cmdMotion": {
            "title": "Motion Command",
            "description": "Command line to execute when a motion event is detected.",
            "type": "string"
          },

          "primaryRelay": {
            "title": "Primary Relay",
            "description": "Primary relay to trigger for doorbell lock events. Default: 1",
            "type": "string"
          },

          "videoConfig": {
            "title": "Video Configuration",
            "description": "Configure optional video parameters.",
            "type": "object",
            "properties": {
              "source": {
                "title": "Video Source",
                "description": "URL to use as the video stream source for FFmpeg.",
                "type": "string"
              },

              "stillImageSource": {
                "title": "Image Source",
                "description": "URL to use as the snapshot images for FFmpeg.",
                "type": "string"
              },

              "additionalCommandline": {
                "title": "Additional command line options to pass to ffmpeg",
                "description": "Additional command line options to use with FFmpeg, for example '-loglevel verbose'.",
                "type": "string"
              },

              "mapaudio": {
                "title": "Map Audio",
                "description": "Stream to use for audio.",
                "type": "string"
              },

              "mapvideo": {
                "title": "Map Video",
                "description": "Stream to use for video.",
                "type": "string"
              },

              "maxStreams": {
                "title": "Maximum Streams",
                "description": "The maximum number of streams that will be generated for this camera. Default: 4",
                "type": "integer",
                "minimum": 1
              },
              
              "maxWidth": {
                "title": "Maximum Width",
                "description": "The maximum width reported to HomeKit. Default: 1280",
                "type": "integer",
                "minimum": 1
              },
              
              "maxHeight": {
                "title": "Maximum Height",
                "description": "The maximum height reported to HomeKit. Default: 720",
                "type": "integer",
                "minimum": 1
              },
              
              "maxFPS": {
                "title": "Maximum FPS",
                "description": "The maximum frame rate of the stream. Default: 15",
                "type": "integer"
              },
              
              "packetSize": {
                "title": "Packet Size",
                "description": "Packet size to use for streaming. Must be in multiples of 188. Default: 376",
                "type": "integer",
                "multipleOf": 188.0
              },
              
              "debug": {
                "title": "Video Debug Mode",
                "description": "Enable video debugging for this Doorbird. Default: false",
                "type": "boolean"
              }
            }
          }
        }
      }
    }
  },
  
  "layout": [
    {
      "name": "General Options",
      "type": "array",
      "items": [
        {
          "items": [
            "name",
            "videoProcessor",
            "audio",
            "debug"
          ]
        }
      ]
    },

    {
      "key": "doorbirds",
      "name": "Doorbirds",
      "type": "array",
      "orderable": false,
      "buttonText": "Add Doorbird",
      "items": [
        "doorbirds[].name",
        "doorbirds[].ip",
        "doorbirds[].username",
        "doorbirds[].password",
        "doorbirds[].primaryRelay",
        "doorbirds[].cmdDoorbell",
        "doorbirds[].cmdMotion",
        {
          "key": "doorbirds[].videoConfig",
          "type": "section",
          "title": "Advanced Settings (Optional)",
          "expandable": true,
          "expanded": false,
          "items": [
            "doorbirds[].videoConfig.source",
            "doorbirds[].videoConfig.stillImageSource",
            "doorbirds[].videoConfig.additionalCommandline",
            "doorbirds[].videoConfig.mapaudio",
            "doorbirds[].videoConfig.mapvideo",
            "doorbirds[].videoConfig.maxStreams",
            "doorbirds[].videoConfig.maxWidth",
            "doorbirds[].videoConfig.maxHeight",
            "doorbirds[].videoConfig.maxFPS",
            "doorbirds[].videoConfig.packetSize",
            "doorbirds[].videoConfig.debug"
          ]
        }
      ]
    }
  ]
}
